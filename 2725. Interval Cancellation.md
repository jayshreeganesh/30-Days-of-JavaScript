# Interval Cancellation

A TypeScript/JavaScript function that executes a given function immediately and then at regular intervals until cancelled.

## Problem Description

Given a function `fn`, an array of arguments `args`, and an interval time `t`, return a cancel function `cancelFn`. The function `fn` should be called with `args` immediately and then called again every `t` milliseconds until `cancelFn` is called.

## Solution

### TypeScript Implementation

```typescript
type JSONValue = null | boolean | number | string | JSONValue[] | { [key: string]: JSONValue };
type Fn = (...args: JSONValue[]) => void

function cancellable(fn: Fn, args: JSONValue[], t: number): Function {
    // Call the function immediately
    fn(...args);
    
    // Set up the interval to call the function repeatedly
    const intervalId = setInterval(() => {
        fn(...args);
    }, t);
    
    // Return a cancel function that clears the interval
    return function cancelFn() {
        clearInterval(intervalId);
    };
};
```

### JavaScript Implementation

```javascript
var cancellable = function(fn, args, t) {
    // Call the function immediately
    fn(...args);
    
    // Set up the interval to call the function repeatedly
    const intervalId = setInterval(() => {
        fn(...args);
    }, t);
    
    // Return a cancel function that clears the interval
    return function cancelFn() {
        clearInterval(intervalId);
    };
};
```

## How It Works

1. **Immediate Execution**: The function `fn` is called immediately with the provided arguments `args`
2. **Interval Setup**: `setInterval` is used to repeatedly call `fn` with `args` every `t` milliseconds
3. **Cancel Function**: Returns a function that, when called, stops the interval using `clearInterval`

## Usage Example

```javascript
const result = [];

const fn = (x) => x * 2;
const args = [4], t = 35, cancelTimeMs = 190;

const start = performance.now();

const log = (...argsArr) => {
    const diff = Math.floor(performance.now() - start);
    result.push({"time": diff, "returned": fn(...argsArr)});
}

const cancel = cancellable(log, args, t);

setTimeout(cancel, cancelTimeMs);

setTimeout(() => {
    console.log(result);
    // Output:
    // [
    //     {"time":0,"returned":8},
    //     {"time":35,"returned":8},
    //     {"time":70,"returned":8},
    //     {"time":105,"returned":8},
    //     {"time":140,"returned":8},
    //     {"time":175,"returned":8}
    // ]
}, cancelTimeMs + t + 15);
```

## Constraints

- `fn` is a function
- `args` is a valid JSON array
- `1 <= args.length <= 10`
- `30 <= t <= 100` (milliseconds)
- `10 <= cancelTimeMs <= 500` (milliseconds)

## Key Features

- **Type Safety** (TypeScript version): Ensures proper typing of function arguments and return values
- **Immediate Execution**: Function executes right away, not waiting for the first interval
- **Clean Cancellation**: Provides a simple way to stop the interval execution
- **JSON-Compatible**: Works with JSON-serializable values only

## Use Cases

- Polling mechanisms
- Regular data updates
- Timed animations
- Periodic API calls
- Any scenario requiring repeated execution with cancellation capability
